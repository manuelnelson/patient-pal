{"version":3,"sources":["../../src/server/api/photo-routes.js"],"names":["router","Router","s3","S3","upload","storage","bucket","acl","metadata","req","file","cb","fieldName","fieldname","key","Date","now","toString","route","post","single","uploadPhoto","param","load"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAJA,IAAMA,SAAS,kBAAQC,MAAR,EAAf,C,CAAiC;;;AAMjC,IAAIC,KAAK,IAAI,iBAAIC,EAAR,EAAT;AACA,IAAIC,SAAS,sBAAO;AAClBC,WAAS,uBAAS;AAChBH,QAAIA,EADY;AAEhBI,YAAQ,cAFQ;AAGhBC,SAAK,aAHW;AAIhBC,cAAU,kBAACC,GAAD,EAAKC,IAAL,EAAUC,EAAV,EAAiB;AACzBA,SAAG,IAAH,EAAS,EAACC,WAAWF,KAAKG,SAAjB,EAAT;AACD,KANe;AAOhBC,SAAK,aAACL,GAAD,EAAKC,IAAL,EAAUC,EAAV,EAAgB;AACnBA,SAAG,IAAH,EAASI,KAAKC,GAAL,GAAWC,QAAX,EAAT;AACD;AATe,GAAT;AADS,CAAP,CAAb;;AAcAjB,OAAOkB,KAAP,CAAa,yBAAb;AACE;AACA;AAFF,CAGGC,IAHH,CAGQf,OAAOgB,MAAP,CAAc,OAAd,CAHR,EAG+B,8BAAiBC,WAHhD;;AAKA;AACA;AACA;;AAEA;AACArB,OAAOsB,KAAP,CAAa,UAAb,EAAyB,8BAAiBC,IAA1C;AACAvB,OAAOsB,KAAP,CAAa,QAAb,EAAuB,wBAAWC,IAAlC;;kBAEevB,M","file":"photo-routes.js","sourcesContent":["import express from 'express';\r\nimport validate from 'express-validation';\r\nimport paramValidation from '../config/user-validation';\r\nimport { ClientCtrl, AuthCtrl, ProfessionalCtrl} from '../controllers';\r\nconst router = express.Router(); // eslint-disable-line new-cap\r\nimport aws from 'aws-sdk';\r\nimport multer from 'multer';\r\nimport multers3 from 'multer-s3';\r\nimport config from '../config';\r\n\r\nlet s3 = new aws.S3()\r\nlet upload = multer({\r\n  storage: multers3({\r\n    s3: s3,\r\n    bucket: 'practice-pal',\r\n    acl: 'public-read',\r\n    metadata: (req,file,cb) => {\r\n      cb(null, {fieldName: file.fieldname})\r\n    },\r\n    key: (req,file,cb) =>{\r\n      cb(null, Date.now().toString())\r\n    }\r\n  })\r\n})\r\n\r\nrouter.route('/professional/:personId')\r\n  /** POST /api/users - Create new user */\r\n  // .post(AuthCtrl.verifyToken,ClientCtrl.uploadPhoto);\r\n  .post(upload.single('image'),ProfessionalCtrl.uploadPhoto);\r\n  \r\n// router.route('/client/:personId')\r\n//   /** POST /api/users - Create new user */\r\n//   .post(ClientCtrl.uploadPhoto);\r\n\r\n/** Load user when API with userId route parameter is hit */\r\nrouter.param('personId', ProfessionalCtrl.load); \r\nrouter.param('userId', ClientCtrl.load); \r\n\r\nexport default router;\r\n"]}