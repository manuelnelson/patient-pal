{"version":3,"sources":["../../src/server/controllers/curriculum-controller.js"],"names":["load","req","res","next","id","get","then","curriculum","catch","e","json","create","body","save","savedCurriculum","update","prop","list","query","limit","skip","curriculums","remove","deletedCurriculum","search","regex","RegExp","params","keyword","find","name","$regex"],"mappings":"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","file":"curriculum-controller.js","sourcesContent":["import {Curriculum} from '../models';\r\nimport APIError from '../lib/APIError';\r\nimport httpStatus from 'http-status';\r\nimport Constants from '../lib/constants';\r\n/**\r\n* Load curriculum and append to req.\r\n*/\r\nfunction load(req, res, next, id) {\r\n    Curriculum.get(id)\r\n        .then((curriculum) => {\r\n            req.curriculum = curriculum;\r\n            return next();\r\n        })\r\n        .catch(e => next(e));\r\n}\r\n\r\n/**\r\n* Get curriculum\r\n* @returns {Curriculum}\r\n*/\r\nfunction get(req, res) {\r\n    return res.json(req.curriculum);\r\n}\r\n\r\n/**\r\n* Checks if user exists with same email as curriculum.  If not, it creates a new User with the email provided and a default password. Then creates the Curriculum to reside in the new user\r\n* @returns {Curriculum}\r\n*/\r\nfunction create(req, res, next) {\r\n    const curriculum = new Curriculum(req.body)\r\n        .save()\r\n        .then(savedCurriculum => res.json(savedCurriculum))\r\n        .catch(e => next(e));\r\n}\r\n\r\n/**\r\n* Update existing curriculum\r\n* @returns {Curriculum}\r\n*/\r\nfunction update(req, res, next) {\r\n    const curriculum = req.curriculum;\r\n    for(let prop in req.curriculum){\r\n        curriculum[prop] = req.curriculum[prop];\r\n    }\r\n    curriculum.save()\r\n    .then(savedCurriculum => res.json(savedCurriculum))\r\n    .catch(e => next(e));\r\n}\r\n\r\n/**\r\n* Get curriculum list.\r\n* @property {number} req.query.skip - Number of curriculums to be skipped.\r\n* @property {number} req.query.limit - Limit number of curriculums to be returned.\r\n* @returns {Curriculum[]}\r\n*/\r\nfunction list(req, res, next) {\r\n    const { limit = 20, skip = 0 } = req.query;\r\n    Curriculum.list({ limit, skip })\r\n    .then(curriculums => res.json(curriculums))\r\n    .catch(e => next(e));\r\n}\r\n\r\n/**\r\n* Delete curriculum.\r\n* @returns {Curriculum}\r\n*/\r\nfunction remove(req, res, next) {\r\n    const curriculum = req.curriculum;\r\n    curriculum.remove()\r\n    .then(deletedCurriculum => res.json(deletedCurriculum))\r\n    .catch(e => next(e));\r\n}\r\n/**\r\n* Get skill\r\n* @returns {Skill}\r\n* https://medium.com/@apurvashastry/build-a-cool-database-search-using-these-mongodb-full-text-search-features-on-mongoose-cf2803257f9\r\n*/\r\nfunction search(req, res, next) {\r\n    var regex = new RegExp(req.params.keyword,'ig')\r\n    Curriculum.find({\r\n        name: {\r\n            $regex: regex\r\n        }\r\n    })\r\n    .then((curriculums) => res.json(curriculums))\r\n    .catch(e => next(e));\r\n}\r\n\r\nexport default { load, get, create, update, list, remove, search };\r\n"]}